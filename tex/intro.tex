\chapter{Introduction}

Signal processing has long relied on well-defined, structured processes and protocols to function.  However, in order to move to more robust and adaptive systems, we will need to overhaul these tightly structured processes.  We must design new robust and adaptive communications systems.

From an academic perspective, the rise of machine learning tools and processing has allowed us to tackle problems we have not yet been able to, like in image processing.  However, we still do not fully understand the reach or the limitations of this technology.  In order to study the limitations of machine learning, we must apply them to spaces that we have studied extensively, like communications, and compare them to the well-known baselines.

Most communications systems have three main processes at the receiver; equalization, demodulation, and error-correction.  While we will need to design robust forms of all of these processes, we will focus on equalization for the remainder of this paper. 

\section{Motivation}
Why are we doing this?

What is meta-learning?

\cite{finn}

\cite{lake}

\section{Background}

\subsection{Inter-symbol Interference and Equalization}

Inter-symbol interference occurs when we are transmitting over a channel that has some echos.  These echos cause the receiver to hear a garbled signal instead of the original signal from the transmitter.  This is called inter-symbol interference because the receiver is hearing a combination of symbols across time. 

Let $\vec{x}=[x_0, x_1, \ldots x_n]$ be the set of $n$ complex symbols that the transmitter sends over the channel that connects the transmitter to the receiver.
Each channel will have different characteristics. Some channels may have echos, others may have delays, often channels will have both.  When a channel has echos, this is called a multipath channel because there are multiple paths to reach the receiver.  Each path is called a tap.  We can characterize a channel by characterizing the taps.

Let $\vec{a} = [a_0, a_1, \ldots a_l]$ be the set of characteristic for a multipath channel that has $l$ taps. When a sequence of symbols like $\vec{x}$ is transmitted over this channel, the channel taps are convolved over the sequence.  Additionally, there is noise in the system denoted by $\eta_i$. 

$$\tilde{x}_m = \sum_{i=0}^l a_i x_{m-i} + \eta_i$$

The receiver will hear a signal that is corrupted by inter-symbol interfence and noise;
$\vec{\tilde{x}}=[\tilde{x}_0, \tilde{x_1}, \ldots \tilde{x}_{n+l}]$. 
Receivers must be able to handle garbled signals in order to transmit data in the real world.  The process of removing the inter-symbol interference is called equalization.  The goal of equalization is to take in a garbled signal and output a signal with minimal inter-symbol interference. 

\setlength{\tabcolsep}{0pt}
\begin{figure}
  \centering
  \label{fig:multi_tap}\caption{The effects of a two tap channel on the QPSK constellation.}
  \begin{tabular}{ccc}
    \includegraphics[width=45mm]{figures/equal_intro/snr_0_c3/cfo_0.png}&
    \includegraphics[width=45mm]{figures/equal_intro/snr_20_c3/cfo_0.png}&
    \includegraphics[width=45mm]{figures/equal_intro/snr_10_c3/cfo_0.png}\\
    \includegraphics[width=45mm]{figures/equal_intro/snr_0_c2/cfo_0.png}&
    \includegraphics[width=45mm]{figures/equal_intro/snr_20_c2/cfo_0.png}&
    \includegraphics[width=45mm]{figures/equal_intro/snr_10_c2/cfo_0.png}\\
    \includegraphics[width=45mm]{figures/equal_intro/snr_0_c4/cfo_0.png}&
    \includegraphics[width=45mm]{figures/equal_intro/snr_20_c4/cfo_0.png}&
    \includegraphics[width=45mm]{figures/equal_intro/snr_10_c4/cfo_0.png}\\
    \includegraphics[width=45mm]{figures/equal_intro/snr_0_c5/cfo_0.png}&
    \includegraphics[width=45mm]{figures/equal_intro/snr_20_c5/cfo_0.png}&
    \includegraphics[width=45mm]{figures/equal_intro/snr_10_c5/cfo_0.png}\\
  \end{tabular}
\end{figure}

Figure ~\ref{fig:multi_tap} demonstrates the effects of multi-tap channels on a QPSK modulation constellation.  We see that under certain channel conditions, like when the two taps are equal, it is very difficult to distinguish between the four constellations.  
Engineers have built processes to remove inter-symbol interference.  First, let's go into the case when the channel characteristics are known.

\subsubsection{Equalization for a known channel}

If you know the channel characteristics, $\vec{a}$, perfectly, then there are a few different methods that can be used. 

Zero-forcing

While it's important to consider how well a receiver can equalize with a known channel, this is rarely the case.  Usually, we do not know the channel characteristics.

\subsubsection{Equalization for an unknown channel}
When the receiver does not know the channel characteristics, the process of equalization essentially has two jobs; first, identify the channel, second, remove the inter-symbol interference. If the receiver did not identify the channel first, there would be no way to remove the affects of it on the received signal. 

In order to do channel estimation, most systems require that packets begin with a known sequence called a preamble. The signal sent will be broken into two parts; $\vec{x} = [\vec{x}_{pre}, \vec{x}_{data}]$.  The signal received on the transmitter is $\vec{\tilde{x}}=[\vec{\tilde{x}}_{pre},\vec{\tilde{x}}_{data}]$.  
The receiver knows what the orginal preamble sequence was, $\vec{x}_{pre}$, and can use the received preamble sequence, $\vec{\tilde{x}}_{pre}$ to estimate the behavior of the channel.
Once the channel is estimated, the receiver then equalizes the data, $\vec{\tilde{x}}_{data}$.

Channel estimation: least squares

Minimum mean squared error equalizer.
 
 

\subsubsection{How do real systems handle equalization?}

OFDM does not have this problem!

 
\subsection{Carrier Frequency Offset and Correction}

Now, if we were to implement our minimum mean squared error algorithm on a physical receiver, we would find some problems with our equalization process.  
Our equalizer will equalize the first symbols very well.  However, as we equalize end parts of our sequence, we will encounter a physical phenomonen called carrier frequency offset, CFO.

Carrier frequency offset occurs when ???

When there is a significant CFO present, our symbols will gradually start rotating. CFO will effect our received symbols like

$$\tilde{x}_m = x_m e^{mj\omega}$$


The effect will look like something like this 

\setlength{\tabcolsep}{0pt}
\begin{figure}
  \centering
  \label{fig:single_tap_cfo}\caption{The effects of a carrier frequency offset on the QPSK constellation.}
  \begin{tabular}{ccc}
    \includegraphics[width=50mm]{figures/cfo_intro/snr_0/cfo_0.png}&
    \includegraphics[width=50mm]{figures/cfo_intro/snr_0/cfo_1.png}&
    \includegraphics[width=50mm]{figures/cfo_intro/snr_0/cfo_2.png}\\
    \includegraphics[width=50mm]{figures/cfo_intro/snr_20/cfo_0.png}&
    \includegraphics[width=50mm]{figures/cfo_intro/snr_20/cfo_1.png}&
    \includegraphics[width=50mm]{figures/cfo_intro/snr_20/cfo_2.png}\\
    \includegraphics[width=50mm]{figures/cfo_intro/snr_10/cfo_0.png}&
    \includegraphics[width=50mm]{figures/cfo_intro/snr_10/cfo_1.png}&
    \includegraphics[width=50mm]{figures/cfo_intro/snr_10/cfo_2.png}
  \end{tabular}
\end{figure}


\subsubsection{How do real systems handle CFO correction?}

There are a few ways to handle CFO, some are more elegant than others. 

The first solution is to try to remove the problem.  Since CFO is dependent on the length of a packet, one solution is to make packets so short that 

A more elegant solution is using phase-lock loops (costas loops).

What must a modern day receiver handle?  What does it look like when we have both CFO and ISI?

$$\tilde{x}_m = (\sum_{i=0}^l a_i x_{m-i})e^{mj\omega} + \eta_i$$

\setlength{\tabcolsep}{0pt}
\begin{figure}
  \centering
  \label{fig:multi_tap_cfo}\caption{The effects of a two tap channel and a carrier frequency offset on the QPSK constellation.}
  \begin{tabular}{ccc}
    \includegraphics[width=45mm]{figures/cfo_equal_intro/snr_0_c3/cfo_0.png}&
    \includegraphics[width=45mm]{figures/cfo_equal_intro/snr_20_c3/cfo_0.png}&
    \includegraphics[width=45mm]{figures/cfo_equal_intro/snr_10_c3/cfo_0.png}\\
    \includegraphics[width=45mm]{figures/cfo_equal_intro/snr_0_c2/cfo_0.png}&
    \includegraphics[width=45mm]{figures/cfo_equal_intro/snr_20_c2/cfo_0.png}&
    \includegraphics[width=45mm]{figures/cfo_equal_intro/snr_10_c2/cfo_0.png}\\
    \includegraphics[width=45mm]{figures/cfo_equal_intro/snr_0_c4/cfo_0.png}&
    \includegraphics[width=45mm]{figures/cfo_equal_intro/snr_20_c4/cfo_0.png}&
    \includegraphics[width=45mm]{figures/cfo_equal_intro/snr_10_c4/cfo_0.png}\\
    \includegraphics[width=45mm]{figures/cfo_equal_intro/snr_0_c5/cfo_0.png}&
    \includegraphics[width=45mm]{figures/cfo_equal_intro/snr_20_c5/cfo_0.png}&
    \includegraphics[width=45mm]{figures/cfo_equal_intro/snr_10_c5/cfo_0.png}\\
  \end{tabular}
\end{figure}

\section{Related Works}

\input{related_works}